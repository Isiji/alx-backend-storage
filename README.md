dealing with advanced sql for back end storage